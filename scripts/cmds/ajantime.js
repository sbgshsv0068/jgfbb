const moment = require('moment-timezone');

module.exports.config = {
  name: "ajan",
  version: "2.0.0",
  role: 0,
  author: "SIDDIK",
  description: "AutoTime for prayer notifications",
  category: "AutoTime",
  countDown: 3
};

module.exports.onLoad = async ({ api }) => {
  const arrayData = {
    "05:04:00 AM": {
      message: `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ðŸŒ™âœ¨ à¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ âœ¨ðŸŒ™  â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ðŸ“¿ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®!ðŸ–¤ðŸ’«
à¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨à§‡à¦°à¦¾, 
à¦à¦–à¦¨ à¦«à¦œà¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ 
à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨à¥¤
à¦«à¦œà¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡à¦‡ à¦¶à§à¦°à§ à¦¹à¦¬à§‡à¥¤âœ¨ðŸ§¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ð“ð‡ð„ ð‚ð€ð‹ð‹ ð“ðŽ ðð‘ð€ð˜ð„ð‘ ð–ð€ð’ ð†ðˆð•ð„ð
`
    },
    "12:59:00 PM": {
      message: `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ðŸŒ™âœ¨ à¦œà§‹à¦¹à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ âœ¨ðŸŒ™  â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ðŸ“¿ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®!ðŸ–¤ðŸ’«
à¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨à§‡à¦°à¦¾, 
à¦à¦–à¦¨ à¦œà§‹à¦¹à¦°à§‡à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ 
à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨à¥¤
à¦œà§‹à¦¹à¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡à¦‡ à¦¶à§à¦°à§ à¦¹à¦¬à§‡à¥¤âœ¨ðŸ§¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ð“ð‡ð„ ð‚ð€ð‹ð‹ ð“ðŽ ðð‘ð€ð˜ð„ð‘ ð–ð€ð’ ð†ðˆð•ð„ð
`
    },
    "03:44:00 PM": {
      message: `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ    ðŸŒ™âœ¨ à¦†à¦¸à¦° à¦†à¦œà¦¾à¦¨ âœ¨ðŸŒ™  â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ðŸ“¿ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®!ðŸ–¤ðŸ’«
à¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨à§‡à¦°à¦¾, 
à¦à¦–à¦¨ à¦†à¦¸à¦° à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ 
à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨à¥¤
à¦†à¦¸à¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡à¦‡ à¦¶à§à¦°à§ à¦¹à¦¬à§‡à¥¤âœ¨ðŸ§¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ð“ð‡ð„ ð‚ð€ð‹ð‹ ð“ðŽ ðð‘ð€ð˜ð„ð‘ ð–ð€ð’ ð†ðˆð•ð„ð
`
    },
    "06:03:00 PM": {
      message: `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ðŸŒ™âœ¨ à¦®à¦¾à¦—à¦°à¦¿à¦¬ à¦†à¦œà¦¾à¦¨ âœ¨ðŸŒ™   â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ðŸ“¿ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®!ðŸ–¤ðŸ’«
à¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨à§‡à¦°à¦¾, 
à¦à¦–à¦¨ à¦®à¦¾à¦—à¦°à¦¿à¦¬ à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ 
à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨à¥¤
à¦®à¦¾à¦—à¦°à¦¿à¦¬ à¦¨à¦¾à¦®à¦¾à¦œ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡à¦‡ à¦¶à§à¦°à§ à¦¹à¦¬à§‡à¥¤âœ¨ðŸ§¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ð“ð‡ð„ ð‚ð€ð‹ð‹ ð“ðŽ ðð‘ð€ð˜ð„ð‘ ð–ð€ð’ ð†ðˆð•ð„ð
`
    },
    "07:29:00 PM": {
      message: `
â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ   ðŸŒ™âœ¨ à¦‡à¦¶à¦¾ à¦†à¦œà¦¾à¦¨ âœ¨ðŸŒ™    â”ƒ
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ðŸ“¿ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®!ðŸ–¤ðŸ’«
à¦ªà§à¦°à¦¿à§Ÿ à¦®à§à¦¸à¦²à¦¿à¦® à¦­à¦¾à¦‡ à¦“ à¦¬à§‹à¦¨à§‡à¦°à¦¾, 
à¦à¦–à¦¨ à¦‡à¦¶à¦¾ à¦†à¦œà¦¾à¦¨ à¦¦à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡à¥¤ 
à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¿à¦¨à¥¤
à¦‡à¦¶à¦¾ à¦¨à¦¾à¦®à¦¾à¦œ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡à¦‡ à¦¶à§à¦°à§ à¦¹à¦¬à§‡à¥¤âœ¨ðŸ§¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ð“ð‡ð„ ð‚ð€ð‹ð‹ ð“ðŽ ðð‘ð€ð˜ð„ð‘ ð–ð€ð’ ð†ðˆð•ð„ð
`
    }
  };

  const checkTimeAndSendMessage = () => {
    const now = moment().tz('Asia/Dhaka');
    const currentTime = now.format('hh:mm:ss A');

    const messageData = arrayData[currentTime];

    if (messageData) {
      const tid = global.db.allThreadData.map(i => i.threadID);
      tid.forEach(async (threadID) => {
        api.sendMessage({ body: messageData.message }, threadID);
      });
    }

    const nextMinute = moment().add(1, 'minute').startOf('minute');
    const delay = nextMinute.diff(moment());
    setTimeout(checkTimeAndSendMessage, delay);
  };

  checkTimeAndSendMessage();
};

module.exports.onStart = () => {};
